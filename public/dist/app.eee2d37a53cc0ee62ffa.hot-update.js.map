{"version":3,"sources":["webpack:///./public/javascripts/modules/typeAhead.js"],"names":["searchResultsHTML","logEntries","map","log","slug","name","join","typeAhead","search","searchInput","querySelector","searchResults","addEventListener","value","style","display","axios","get","then","res","data","length","innerHTML","dompurify","sanitize","catch","err","console","error","e","includes","keyCode","activeClass","current","items","querySelectorAll","next","nextElementSibling","previousElementSibling","href","window","location","classList","remove","add"],"mappings":"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","file":"app.eee2d37a53cc0ee62ffa.hot-update.js","sourcesContent":["import axios from 'axios';\nimport dompurify from 'dompurify';\n\nfunction searchResultsHTML(logEntries) {\n  return logEntries.map(log => {\n    return `\n      <a href=\"/log/${log.slug}\" class=\"search__result\">\n        <strong>${log.name}</strong>\n      </a>\n    `;\n  }).join('');\n}\n\nfunction typeAhead(search) {\n  if (!search) return;\n  // console.log('Search input detected...')\n  // console.table(search)\n\n  const searchInput = search.querySelector('input[name=\"search\"]');\n  const searchResults = search.querySelector('.search__results');\n\n  searchInput.addEventListener('input', function() {\n    if (!this.value) {\n      searchResults.style.display = 'none';\n      return; \n    }\n\n    searchResults.style.display = 'block';\n\n    axios\n      .get(`/api/search?q=${this.value}`)\n      .then(res => {\n        // console.log('CLIENT - api search for '+this.value+'. Result: ')\n        // console.log(res.data)\n\n        if (res.data.length) {\n          searchResults.innerHTML = dompurify.sanitize(searchResultsHTML(res.data));\n          return;\n        }\n        // If nothing came back...\n        searchResults.innerHTML = dompurify.sanitize(`<div class=\"search__result\">No results for ${this.value}</div>`);\n      })\n      .catch(err => {\n        console.error(err);\n      });\n  });\n\n  searchInput.addEventListener('keyup', (e) => {\n    // Ignore keys except up, down and enter for keyboard selection of result link\n    if (![38, 40, 13].includes(e.keyCode)) {\n      return; \n    }\n    const activeClass = 'search__result--active';\n    const current = search.querySelector(`.${activeClass}`);\n    const items = search.querySelectorAll('.search__result');\n    let next;\n    if (e.keyCode === 40 && current) {\n      next = current.nextElementSibling || items[0];\n    } else if (e.keyCode === 40) {\n      next = items[0];\n    } else if (e.keyCode === 38 && current) {\n      next = current.previousElementSibling || items[items.length - 1]\n    } else if (e.keyCode === 38) {\n      next = items[items.length - 1];\n    } else if (e.keyCode === 13 && current.href) {\n      window.location = current.href;\n      return;\n    }\n    if (current) {\n      current.classList.remove(activeClass);\n    }\n    next.classList.add(activeClass);\n  });\n}\n\nexport default typeAhead;\n"],"sourceRoot":""}